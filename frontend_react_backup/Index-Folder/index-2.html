<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK Processor 4.2.1 - Smart AI Dashboard</title>
    <style>
        /* Core Theme System */
        :root {
            /* Default Dark Theme */
            --bg-primary: #0a0e27;
            --bg-secondary: #1a1f3a;
            --bg-card: rgba(0,0,0,0.8);
            --text-primary: #00ff88;
            --text-secondary: #e0e7ff;
            --text-dark: #000;
            --accent-primary: #667eea;
            --accent-secondary: #764ba2;
            --border-color: #00ff88;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Light Theme */
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #e2e8f0;
            --bg-card: #ffffff;
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-dark: #ffffff;
            --accent-primary: #667eea;
            --accent-secondary: #5a67d8;
            --border-color: #e2e8f0;
        }

        /* Cyber Theme */
        [data-theme="cyber"] {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-card: rgba(0, 255, 0, 0.05);
            --text-primary: #00ff00;
            --text-secondary: #00cc00;
            --border-color: #00ff00;
            --accent-primary: #ff00ff;
            --accent-secondary: #00ffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-secondary);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Connection Status Bar */
        .connection-status-bar {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            backdrop-filter: blur(10px);
        }

        .connection-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .connection-status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-connected { background: var(--success); }
        .status-disconnected { background: var(--error); }
        .status-syncing { background: var(--warning); }

        .integration-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .integration-btn:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        /* Smart AI Guidance Panel */
        .ai-guidance-panel {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .ai-guidance-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .ai-guidance-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .ai-avatar {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
        }

        .ai-guidance-content {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-primary);
        }

        .next-task-suggestion {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid var(--accent-primary);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .task-dependency-chain {
            margin-top: 15px;
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .dependency-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 14px;
        }

        .dependency-arrow {
            margin: 0 10px;
            color: var(--accent-primary);
        }

        /* Analytics Dashboard */
        .analytics-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .chart-container {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            height: 250px;
            position: relative;
        }

        .chart-title {
            color: var(--text-primary);
            font-weight: bold;
            margin-bottom: 15px;
        }

        .chart-placeholder {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            border: 2px dashed var(--border-color);
        }

        .insight-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .insight-title {
            color: var(--accent-primary);
            font-weight: bold;
            margin-bottom: 8px;
        }

        .insight-text {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.4;
        }

        /* Authentication Modals */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .auth-content {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--border-color);
        }

        .auth-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
        }

        .auth-title {
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: bold;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-label {
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
        }

        .form-input {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .auth-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-btn.primary {
            background: var(--accent-primary);
            color: white;
        }

        .auth-btn.secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .auth-btn:hover {
            transform: translateY(-1px);
        }

        /* Task Detail Modal */
        .task-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .task-detail-content {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            max-width: 900px;
            width: 90%;
            max-height: 85%;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .task-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
        }

        .task-detail-title {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .task-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .meta-item {
            background: var(--bg-secondary);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .meta-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .meta-value {
            font-size: 16px;
            font-weight: bold;
            color: var(--text-primary);
        }

        .subtasks-section {
            margin-bottom: 25px;
        }

        .subtasks-list {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
        }

        .subtask-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .subtask-item:last-child {
            border-bottom: none;
        }

        .subtask-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--accent-primary);
            border-radius: 4px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .subtask-checkbox.completed {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .subtask-details {
            flex: 1;
        }

        .subtask-name {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 3px;
        }

        .subtask-description {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .subtask-hours {
            background: rgba(102, 126, 234, 0.2);
            color: var(--accent-primary);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-left: 10px;
        }

        .task-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .task-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .task-btn.primary {
            background: var(--accent-primary);
            color: white;
        }

        .task-btn.success {
            background: var(--success);
            color: white;
        }

        .task-btn.secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .task-btn:hover {
            transform: translateY(-2px);
        }

        /* Code Examples Modal */
        .code-example-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .code-example-content {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 80%;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .code-example-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .code-block {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .code-language {
            background: var(--accent-primary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 10px;
            display: inline-block;
        }

        /* Enhanced Progress Cards */
        .enhanced-progress-card {
            position: relative;
        }

        .progress-insights {
            margin-top: 15px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: 14px;
        }

        .velocity-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }

        .velocity-trend {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 10px;
            background: rgba(34, 197, 94, 0.2);
            color: var(--success);
        }

        .header {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.95;
            margin-bottom: 20px;
        }

        .live-status {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            padding: 10px 20px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -450px;
            width: 450px;
            height: 100vh;
            background: var(--bg-secondary);
            border-left: 2px solid var(--border-color);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            box-shadow: -5px 0 15px rgba(0,0,0,0.3);
        }

        .settings-panel.active {
            right: 0;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background: var(--gradient-primary);
            color: white;
        }

        .settings-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .settings-close:hover {
            transform: rotate(90deg);
        }

        .settings-section {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .settings-section h3 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* LLM Selector Styles */
        .llm-selector-container {
            margin-top: 15px;
        }

        .llm-dropdown {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23667eea" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 12px;
        }

        .llm-dropdown:hover, .llm-dropdown:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            outline: none;
        }

        .llm-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .llm-status.connected {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .llm-status.local {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .llm-icon {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        /* Plugin System Styles - UPDATED */
        .plugin-code-area {
            margin-top: 15px;
        }

        .plugin-textarea {
            width: 100%;
            height: 150px;
            padding: 12px;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            resize: vertical;
        }

        .plugin-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .plugin-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .plugin-btn:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .plugin-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .plugin-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .plugin-info {
            flex: 1;
        }

        .plugin-name {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .plugin-description {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .theme-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .theme-option {
            padding: 15px;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: var(--bg-card);
        }

        .theme-option:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .theme-option.active {
            border-color: var(--text-primary);
            background: rgba(102, 126, 234, 0.2);
        }

        /* Settings Toggle Button */
        .settings-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 999;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .settings-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .chat-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            transition: all 0.3s;
        }

        .chat-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 400px;
            height: 500px;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            display: none;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .chat-window.active {
            display: flex;
        }

        .chat-header {
            padding: 15px;
            background: var(--gradient-primary);
            color: white;
            border-radius: 13px 13px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-ai-indicator {
            font-size: 12px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: var(--bg-secondary);
        }

        .chat-message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 10px;
            animation: fadeInUp 0.3s ease;
        }

        .chat-message.user {
            background: var(--accent-primary);
            color: white;
            margin-left: 20%;
            text-align: right;
        }

        .chat-message.assistant {
            background: var(--bg-card);
            color: var(--text-primary);
            margin-right: 20%;
            border: 1px solid var(--border-color);
        }

        .chat-message.system {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            text-align: center;
            font-style: italic;
            margin: 10px 0;
            border: 1px dashed var(--border-color);
        }

        .chat-message.typing {
            background: var(--bg-card);
            color: var(--text-secondary);
            margin-right: 20%;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-primary);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .chat-input-area {
            padding: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            outline: none;
        }

        .chat-send {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .chat-send:hover {
            background: var(--accent-secondary);
            transform: translateX(2px);
        }

        .chat-send:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .stat-number {
            font-size: 2.8rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        .stat-change {
            font-size: 0.9rem;
            margin-top: 5px;
            padding: 4px 8px;
            border-radius: 20px;
            background: rgba(102, 126, 234, 0.1);
            color: var(--accent-primary);
            display: inline-block;
        }

        /* Progress Overview */
        .progress-overview {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .progress-title {
            font-size: 1.8rem;
            color: var(--text-primary);
            font-weight: bold;
        }

        .progress-percentage {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-primary);
        }

        .progress-bar {
            width: 100%;
            height: 24px;
            background: var(--bg-secondary);
            border-radius: 12px;
            overflow: hidden;
            margin: 15px 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 12px;
            transition: all 1s ease;
            width: 0%;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Milestones */
        .milestones {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .milestone {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            position: relative;
            transition: all 0.3s;
        }

        .milestone:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .milestone.completed {
            background: rgba(34, 197, 94, 0.1);
            border-color: var(--success);
        }

        .milestone.current {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--warning);
        }

        .milestone-status {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            font-size: 12px;
            font-weight: bold;
        }

        .milestone.completed .milestone-status {
            background: var(--success);
            color: white;
        }

        .milestone.current .milestone-status {
            background: var(--warning);
            color: white;
        }

        /* Roadmap */
        .roadmap {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .phase-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-left: 5px solid var(--accent-primary);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .phase-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .phase-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .phase-number {
            background: var(--gradient-primary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .phase-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: bold;
            margin-left: 15px;
        }

        .phase-timeline {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .phase-progress {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
        }

        .phase-progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .phase-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #16a34a);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .phase-progress-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
        }

        .project-list {
            list-style: none;
        }

        .project-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }

        .project-item:hover {
            background: rgba(102, 126, 234, 0.1);
            margin: 0 -10px;
            padding: 12px 10px;
            border-radius: 8px;
        }

        .project-item:last-child {
            border-bottom: none;
        }

        .project-status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
            font-weight: bold;
            transition: all 0.3s;
        }

        .status-not-started {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }

        .status-in-progress {
            background: linear-gradient(135deg, var(--warning), #d97706);
            animation: pulse 2s infinite;
        }

        .status-completed {
            background: linear-gradient(135deg, var(--success), #16a34a);
        }

        .project-name {
            flex: 1;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .project-progress {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-right: 10px;
        }

        .project-priority {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 600;
            margin-right: 10px;
        }

        .priority-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
        }

        .priority-high {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .priority-medium {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .start-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .start-btn:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .start-btn:disabled {
            background: var(--bg-secondary);
            cursor: not-allowed;
            transform: none;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card);
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-left: 4px solid;
            z-index: 3000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification.error {
            border-left-color: var(--error);
        }

        .notification.info {
            border-left-color: var(--info);
        }

        .hidden {
            display: none !important;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .roadmap {
                grid-template-columns: 1fr;
            }
            
            .chat-window {
                width: 100%;
                right: -10px;
                left: 10px;
            }

            .connection-status-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .settings-panel {
                width: 100%;
                right: -100%;
            }

            .task-detail-content {
                width: 95%;
                padding: 20px;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body data-theme="light">
    <!-- Settings Toggle -->
    <button class="settings-toggle" onclick="toggleSettings()">
        <span>âš™</span>
        <span>Settings</span>
    </button>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h2>âš™ Settings</h2>
            <button class="settings-close" onclick="toggleSettings()">Ã—</button>
        </div>
        
        <div class="settings-section">
            <h3>ðŸ¤– AI Assistant</h3>
            <div class="llm-selector-container">
                <label for="llmSelector" style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-size: 14px;">Select AI Model:</label>
                <select id="llmSelector" class="llm-dropdown" onchange="changeLLM()">
                    <option value="gpt4">ðŸ§  OpenAI GPT-4</option>
                    <option value="claude">ðŸŽ­ Anthropic Claude</option>
                    <option value="gemini">âœ¨ Google Gemini</option>
                    <option value="ollama">ðŸ  Ollama Local</option>
                </select>
                <div id="llmStatus" class="llm-status connected">
                    <div class="llm-icon" style="background: #10a37f;"></div>
                    <span>GPT-4 Active</span>
                </div>
            </div>
        </div>

        <!-- Custom Plugin System -->
        <div class="settings-section">
            <h3>ðŸ§© Custom Plugins</h3>
            <div class="plugin-code-area">
                <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-size: 14px;">Paste HTML/CSS/JS Code to Add Features:</label>
                <textarea 
                    id="pluginCodeInput" 
                    class="plugin-textarea" 
                    placeholder="<!-- Paste your HTML code here to add custom features -->
<div id='custom-widget' style='background: #667eea; color: white; padding: 10px; border-radius: 8px; margin: 10px 0;'>
  <h4>Custom Widget</h4>
  <p>Your custom functionality here!</p>
  <button onclick='alert(&quot;Custom feature works!&quot;)'>Test</button>
</div>

<script>
console.log('Custom plugin loaded!');
</script>"></textarea>
                <div class="plugin-actions">
                    <button class="plugin-btn" onclick="installCustomPlugin()">Install Plugin</button>
                    <button class="plugin-btn" onclick="clearPluginCode()">Clear</button>
                </div>
            </div>
            <div class="plugin-list" id="customPluginsList">
                <!-- Installed custom plugins will appear here -->
            </div>
        </div>

        <!-- Integration Settings with Auth -->
        <div class="settings-section">
            <h3>ðŸ”— Integrations</h3>
            <div style="margin-top: 15px;">
                <button class="integration-btn" onclick="showGitHubAuth()">Connect GitHub</button>
                <button class="integration-btn" onclick="showHubSpotAuth()">Connect HubSpot</button>
            </div>
            <div style="margin-top: 15px; padding: 10px; background: var(--bg-card); border-radius: 8px; font-size: 12px;">
                <strong>GitHub:</strong> <span id="githubConnectionStatus">Not Connected</span><br>
                <strong>HubSpot:</strong> <span id="hubspotConnectionStatus">Not Connected</span>
            </div>
        </div>
        
        <div class="settings-section">
            <h3>ðŸŽ¨ Theme</h3>
            <div class="theme-selector">
                <div class="theme-option" onclick="setTheme('dark')" data-theme="dark">
                    <div>ðŸŒ™</div>
                    <div>Dark</div>
                </div>
                <div class="theme-option active" onclick="setTheme('light')" data-theme="light">
                    <div>â˜€ï¸</div>
                    <div>Light</div>
                </div>
                <div class="theme-option" onclick="setTheme('cyber')" data-theme="cyber">
                    <div>ðŸ’»</div>
                    <div>Cyber</div>
                </div>
            </div>
        </div>
    </div>

    <!-- GitHub Authentication Modal -->
    <div class="auth-modal" id="githubAuthModal">
        <div class="auth-content">
            <div class="auth-header">
                <div class="auth-title">ðŸ”— Connect GitHub</div>
                <button onclick="closeAuthModal('githubAuthModal')" style="background: none; border: none; color: var(--text-primary); font-size: 24px; cursor: pointer;">Ã—</button>
            </div>
            <form class="auth-form" onsubmit="authenticateGitHub(event)">
                <div class="form-group">
                    <label class="form-label">Repository URL</label>
                    <input type="text" class="form-input" id="githubRepo" placeholder="https://github.com/username/repository" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Personal Access Token</label>
                    <input type="password" class="form-input" id="githubToken" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="githubUsername" placeholder="your-username" required>
                </div>
                <div style="font-size: 12px; color: var(--text-secondary); margin: 10px 0;">
                    <strong>How to get token:</strong> GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens â†’ Generate new token (classic) â†’ Select "repo" scope
                </div>
                <div class="auth-buttons">
                    <button type="button" class="auth-btn secondary" onclick="closeAuthModal('githubAuthModal')">Cancel</button>
                    <button type="submit" class="auth-btn primary">Connect</button>
                </div>
            </form>
        </div>
    </div>

    <!-- HubSpot Authentication Modal -->
    <div class="auth-modal" id="hubspotAuthModal">
        <div class="auth-content">
            <div class="auth-header">
                <div class="auth-title">ðŸ“Š Connect HubSpot</div>
                <button onclick="closeAuthModal('hubspotAuthModal')" style="background: none; border: none; color: var(--text-primary); font-size: 24px; cursor: pointer;">Ã—</button>
            </div>
            <form class="auth-form" onsubmit="authenticateHubSpot(event)">
                <div class="form-group">
                    <label class="form-label">Portal ID</label>
                    <input type="text" class="form-input" id="hubspotPortal" placeholder="12345678" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Private App Access Token</label>
                    <input type="password" class="form-input" id="hubspotToken" placeholder="pat-na1-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Account Name</label>
                    <input type="text" class="form-input" id="hubspotAccount" placeholder="Your Company Name" required>
                </div>
                <div style="font-size: 12px; color: var(--text-secondary); margin: 10px 0;">
                    <strong>How to get token:</strong> HubSpot â†’ Settings â†’ Integrations â†’ Private Apps â†’ Create private app â†’ Add CRM scopes â†’ Generate token
                </div>
                <div class="auth-buttons">
                    <button type="button" class="auth-btn secondary" onclick="closeAuthModal('hubspotAuthModal')">Cancel</button>
                    <button type="submit" class="auth-btn primary">Connect</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chat Widget -->
    <div class="chat-widget">
        <button class="chat-toggle" onclick="toggleChat()">
            <span id="chatIcon">ðŸ’¬</span>
        </button>
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <div>
                    <h3>ðŸ¤– AI Assistant</h3>
                    <div class="chat-ai-indicator" id="chatAiIndicator">
                        <div class="llm-icon" style="background: #10a37f; width: 12px; height: 12px;"></div>
                        <span>GPT-4</span>
                    </div>
                </div>
                <button style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;" onclick="toggleChat()">Ã—</button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <!-- Messages will be added here -->
            </div>
            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask me anything..." onkeypress="handleChatKeypress(event)">
                <button class="chat-send" id="chatSend" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <!-- Task Detail Modal -->
    <div class="task-detail-modal" id="taskDetailModal">
        <div class="task-detail-content">
            <div class="task-detail-header">
                <div class="task-detail-title" id="taskDetailTitle">Project Details</div>
                <button onclick="closeTaskModal()" style="background: none; border: none; color: var(--text-primary); font-size: 24px; cursor: pointer;">Ã—</button>
            </div>
            <div class="task-meta">
                <div class="meta-item">
                    <div class="meta-label">Estimated Hours</div>
                    <div class="meta-value" id="taskHours">24h</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Priority</div>
                    <div class="meta-value" id="taskPriority">Critical</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Dependencies</div>
                    <div class="meta-value" id="taskDependencies">None</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Progress</div>
                    <div class="meta-value" id="taskProgress">0%</div>
                </div>
            </div>
            <div class="subtasks-section">
                <h3 style="color: var(--text-primary); margin-bottom: 15px;">ðŸ“‹ Task Breakdown</h3>
                <div class="subtasks-list" id="subtasksList">
                    <!-- Subtasks will be populated here -->
                </div>
            </div>
            <div class="task-actions">
                <button class="task-btn secondary" onclick="showTaskCode()">View Code Examples</button>
                <button class="task-btn primary" onclick="startTask()">Start Task</button>
                <button class="task-btn success" onclick="completeTask()">Mark Complete</button>
            </div>
        </div>
    </div>

    <!-- Code Example Modal -->
    <div class="code-example-modal" id="codeModal">
        <div class="code-example-content">
            <div class="code-example-header">
                <h3 id="codeTitle">Code Example</h3>
                <button onclick="closeCodeModal()" style="background: none; border: none; color: var(--text-primary); font-size: 24px; cursor: pointer;">Ã—</button>
            </div>
            <div id="codeContent">
                <!-- Code examples will be loaded here -->
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>MK Processor 4.2.1</h1>
            <p>Smart AI-Powered Multi-LLM Development Platform</p>
            <div class="live-status">
                <div class="status-dot"></div>
                <span id="liveStatusText">Smart AI Dashboard Active</span>
            </div>
        </div>

        <!-- Connection Status Bar -->
        <div class="connection-status-bar">
            <div class="connection-item">
                <div class="connection-status-dot status-disconnected" id="githubStatusDot"></div>
                <span id="githubStatusText">GitHub: Not Connected</span>
            </div>
            <div class="connection-item">
                <div class="connection-status-dot status-disconnected" id="hubspotStatusDot"></div>
                <span id="hubspotStatusText">HubSpot: Not Connected</span>
            </div>
            <div class="connection-item">
                <div class="connection-status-dot status-connected"></div>
                <span>Last Sync: <span id="lastSyncTime">Never</span></span>
            </div>
            <div class="connection-item">
                <button class="integration-btn" onclick="generateAnalyticsReport()">Analytics Report</button>
            </div>
        </div>

        <!-- Analytics Dashboard -->
        <div class="analytics-section" id="analyticsSection">
            <div class="analytics-header">
                <h2 style="color: var(--text-primary);">ðŸ“Š Analytics & Insights</h2>
                <button class="integration-btn" onclick="refreshAnalytics()">Refresh Data</button>
            </div>
            <div class="analytics-grid">
                <div class="chart-container">
                    <div class="chart-title">Task Completion Velocity</div>
                    <div class="chart-placeholder" id="velocityChart">
                        ðŸ“ˆ Velocity trending upward<br>
                        <small>3.2 tasks/week average</small>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Project Progress Distribution</div>
                    <div class="chart-placeholder" id="progressChart">
                        ðŸ¥§ Phase 1: 0% | Phase 2-4: Locked<br>
                        <small>Foundation phase active</small>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">AI Model Usage</div>
                    <div class="chart-placeholder" id="aiUsageChart">
                        ðŸ¤– GPT-4: 85% | Claude: 15%<br>
                        <small>Multi-model optimization</small>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Productivity Score</div>
                    <div class="chart-placeholder" id="productivityChart">
                        â­ 8.5/10 Productivity Score<br>
                        <small>Above average performance</small>
                    </div>
                </div>
            </div>
            <div class="insight-card">
                <div class="insight-title">ðŸ’¡ Smart Insights</div>
                <div class="insight-text" id="analyticsInsights">
                    â€¢ You're most productive between 9-11 AM (complete 2.3x more tasks)<br>
                    â€¢ Development Environment tasks have highest completion rate (95%)<br>
                    â€¢ Recommended: Focus on Docker setup next - it unlocks 4 dependent tasks<br>
                    â€¢ GitHub integration would increase velocity by estimated 40%
                </div>
            </div>
        </div>

        <!-- Smart AI Guidance Panel -->
        <div class="ai-guidance-panel">
            <div class="ai-guidance-header">
                <div class="ai-avatar">ðŸ¤–</div>
                <div>
                    <h3 style="color: var(--text-primary); margin: 0;">Smart Project Guidance</h3>
                    <div style="font-size: 14px; opacity: 0.8;">AI analyzing your progress and suggesting next steps</div>
                </div>
            </div>
            <div class="ai-guidance-content">
                <div id="aiGuidanceText">
                    ðŸš€ Ready to analyze your Ultimate Scraper project! Based on your current 0% completion, I recommend starting with the Development Environment setup - it's critical for all future tasks.
                </div>
                <div class="next-task-suggestion">
                    <strong>ðŸŽ¯ Recommended Next Task:</strong>
                    <div id="nextTaskSuggestion">Development Environment Setup - Create repository structure</div>
                    <button class="integration-btn" style="margin-top: 8px;" onclick="showNextTaskCode()">Show Code Examples</button>
                </div>
                <div class="task-dependency-chain">
                    <strong>ðŸ“Š Task Dependencies:</strong>
                    <div id="dependencyChain">
                        <div class="dependency-item">
                            <span>1. Repository Setup</span>
                            <span class="dependency-arrow">â†’</span>
                            <span>2. Docker Config</span>
                            <span class="dependency-arrow">â†’</span>
                            <span>3. Database Init</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="stats-grid">
            <div class="stat-card enhanced-progress-card">
                <div class="stat-number" id="overallProgress">0%</div>
                <div class="stat-label">Overall Progress</div>
                <div class="stat-change" id="progressChange">+0% this week</div>
                <div class="progress-insights">
                    <div class="velocity-indicator">
                        <span>Velocity:</span>
                        <span class="velocity-trend" id="velocityTrend">Starting Phase</span>
                    </div>
                    <div style="margin-top: 5px; font-size: 12px; opacity: 0.8;" id="progressInsight">
                        Complete 3 tasks to establish baseline velocity
                    </div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedTasks">0/38</div>
                <div class="stat-label">Tasks Completed</div>
                <div class="stat-change" id="tasksChange">+0 this week</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="currentPhase">Phase 1</div>
                <div class="stat-label">Current Phase</div>
                <div class="stat-change" id="phaseProgress">Foundation</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="timeToMarket">36</div>
                <div class="stat-label">Months to Market</div>
                <div class="stat-change" id="timelineChange">On track</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="teamVelocity">12</div>
                <div class="stat-label">Sprint Velocity</div>
                <div class="stat-change" id="velocityChange">Story points/week</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeAI">GPT-4</div>
                <div class="stat-label">Active AI Model</div>
                <div class="stat-change" id="aiModelChange">Multi-LLM Ready</div>
            </div>
        </div>

        <!-- Progress Overview -->
        <div class="progress-overview">
            <div class="progress-header">
                <div class="progress-title">ðŸ“Š Project Progress</div>
                <div class="progress-percentage" id="progressPercentage">0%</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%;"></div>
            </div>
            <p id="progressText">ðŸš€ Ready to build Ultimate Scraper! Start working on tasks to track progress.</p>
            
            <div class="milestones">
                <div class="milestone current" id="milestone1">
                    <div class="milestone-status">1</div>
                    <h4>Foundation Setup</h4>
                    <p>Development environment and core infrastructure</p>
                </div>
                <div class="milestone" id="milestone2">
                    <div class="milestone-status">2</div>
                    <h4>MVP Launch</h4>
                    <p>Enterprise web scraping platform</p>
                </div>
                <div class="milestone" id="milestone3">
                    <div class="milestone-status">3</div>
                    <h4>Market Traction</h4>
                    <p>First 100 enterprise customers</p>
                </div>
                <div class="milestone" id="milestone4">
                    <div class="milestone-status">4</div>
                    <h4>Dual Platform</h4>
                    <p>Consumer platform launch</p>
                </div>
            </div>
        </div>

        <!-- Implementation Roadmap -->
        <div class="roadmap">
            <!-- Phase 1: Foundation -->
            <div class="phase-card">
                <div class="phase-header">
                    <div class="phase-number">1</div>
                    <div class="phase-title">Foundation</div>
                </div>
                <div class="phase-timeline">Months 1-4 | Enterprise MVP</div>
                <div class="phase-progress">
                    <div class="phase-progress-bar">
                        <div class="phase-progress-fill" id="phase1Progress" style="width: 0%"></div>
                    </div>
                    <div class="phase-progress-text" id="phase1Text">0% Complete</div>
                </div>
                <ul class="project-list">
                    <li class="project-item">
                        <div class="project-status status-not-started" id="status-dev-env">â—‹</div>
                        <div class="project-name">Development Environment</div>
                        <div class="project-progress" id="progress-dev-env">0/8 tasks</div>
                        <div class="project-priority priority-critical">Critical</div>
                        <button class="start-btn" onclick="openTaskDetails('dev-env')">Work On It</button>
                    </li>
                    <li class="project-item">
                        <div class="project-status status-not-started" id="status-scraping">â—‹</div>
                        <div class="project-name">Web Scraping MVP</div>
                        <div class="project-progress" id="progress-scraping">0/10 tasks</div>
                        <div class="project-priority priority-critical">Critical</div>
                        <button class="start-btn" onclick="openTaskDetails('scraping')">Work On It</button>
                    </li>
                    <li class="project-item">
                        <div class="project-status status-not-started" id="status-ai">â—‹</div>
                        <div class="project-name">AI Integration</div>
                        <div class="project-progress" id="progress-ai">0/10 tasks</div>
                        <div class="project-priority priority-high">High</div>
                        <button class="start-btn" onclick="openTaskDetails('ai')">Work On It</button>
                    </li>
                    <li class="project-item">
                        <div class="project-status status-not-started" id="status-frontend">â—‹</div>
                        <div class="project-name">Frontend Dashboard</div>
                        <div class="project-progress" id="progress-frontend">0/10 tasks</div>
                        <div class="project-priority priority-high">High</div>
                        <button class="start-btn" onclick="openTaskDetails('frontend')">Work On It</button>
                    </li>
                </ul>
            </div>

            <!-- Phase 2: Growth -->
            <div class="phase-card">
                <div class="phase-header">
                    <div class="phase-number">2</div>
                    <div class="phase-title">Growth</div>
                </div>
                <div class="phase-timeline">Months 5-12 | Enterprise Scale</div>
                <div class="phase-progress">
                    <div class="phase-progress-bar">
                        <div class="phase-progress-fill" id="phase2Progress" style="width: 0%"></div>
                    </div>
                    <div class="phase-progress-text" id="phase2Text">0% Complete</div>
                </div>
                <ul class="project-list">
                    <li class="project-item">
                        <div class="project-status status-not-started">â—‹</div>
                        <div class="project-name">Enterprise Features</div>
                        <div class="project-progress">0/5 tasks</div>
                        <div class="project-priority priority-high">High</div>
                        <button class="start-btn" disabled>Locked</button>
                    </li>
                    <li class="project-item">
                        <div class="project-status status-not-started">â—‹</div>
                        <div class="project-name">Customer Acquisition</div>
                        <div class="project-progress">0/5 tasks</div>
                        <div class="project-priority priority-medium">Medium</div>
                        <button class="start-btn" disabled>Locked</button>
                    </li>
                </ul>
            </div>

            <!-- Phase 3: Market -->
            <div class="phase-card">
                <div class="phase-header">
                    <div class="phase-number">3</div>
                    <div class="phase-title">Market</div>
                </div>
                <div class="phase-timeline">Months 13-24 | Market Expansion</div>
                <div class="phase-progress">
                    <div class="phase-progress-bar">
                        <div class="phase-progress-fill" id="phase3Progress" style="width: 0%"></div>
                    </div>
                    <div class="phase-progress-text" id="phase3Text">0% Complete</div>
                </div>
                <ul class="project-list">
                    <li class="project-item">
                        <div class="project-status status-not-started">â—‹</div>
                        <div class="project-name">Market Research</div>
                        <div class="project-progress">0/5 tasks</div>
                        <div class="project-priority priority-medium">Medium</div>
                        <button class="start-btn" disabled>Locked</button>
                    </li>
                </ul>
            </div>

            <!-- Phase 4: Consumer -->
            <div class="phase-card">
                <div class="phase-header">
                    <div class="phase-number">4</div>
                    <div class="phase-title">Consumer</div>
                </div>
                <div class="phase-timeline">Months 25-36 | Consumer Platform</div>
                <div class="phase-progress">
                    <div class="phase-progress-bar">
                        <div class="phase-progress-fill" id="phase4Progress" style="width: 0%"></div>
                    </div>
                    <div class="phase-progress-text" id="phase4Text">0% Complete</div>
                </div>
                <ul class="project-list">
                    <li class="project-item">
                        <div class="project-status status-not-started">â—‹</div>
                        <div class="project-name">Consumer Platform</div>
                        <div class="project-progress">0/5 tasks</div>
                        <div class="project-priority priority-medium">Medium</div>
                        <button class="start-btn" disabled>Locked</button>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Global Application State
        const AppState = {
            ai: {
                currentModel: localStorage.getItem('selectedLLM') || 'gpt4',
                models: {
                    gpt4: {
                        name: 'OpenAI GPT-4',
                        icon: 'ðŸ§ ',
                        color: '#10a37f',
                        isReal: true
                    },
                    claude: {
                        name: 'Anthropic Claude',
                        icon: 'ðŸŽ­',
                        color: '#d97848',
                        isReal: true
                    },
                    gemini: {
                        name: 'Google Gemini',
                        icon: 'âœ¨',
                        color: '#4285f4',
                        isReal: true
                    },
                    ollama: {
                        name: 'Ollama (Local)',
                        icon: 'ðŸ ',
                        color: '#6366f1',
                        isReal: true
                    }
                }
            },
            integrations: {
                github: {
                    connected: false,
                    repo: null,
                    token: null,
                    username: null,
                    lastSync: null
                },
                hubspot: {
                    connected: false,
                    portal: null,
                    token: null,
                    account: null,
                    deals: 0,
                    lastSync: null
                }
            },
            progress: {
                overall: 0,
                completed: 0,
                total: 38,
                velocity: 0,
                phases: {
                    phase1: 0,
                    phase2: 0,
                    phase3: 0,
                    phase4: 0
                }
            },
            settings: {
                theme: localStorage.getItem('theme') || 'light',
                notifications: true,
                sound: true
            },
            customPlugins: JSON.parse(localStorage.getItem('custom_plugins') || '[]'),
            currentTask: null
        };

        // Enhanced project data structure with detailed tasks and subtasks
        const projectData = {
            'dev-env': {
                title: 'Development Environment Setup',
                description: 'Set up the complete development environment for Ultimate Scraper',
                phase: 1,
                priority: 'Critical',
                estimatedHours: 24,
                dependencies: [],
                tasks: [
                    {
                        name: 'Create repository structure',
                        description: 'Initialize Git repository with proper folder structure',
                        hours: 2,
                        codeExample: 'repository-structure'
                    },
                    {
                        name: 'Setup Docker containerization',
                        description: 'Create Dockerfile and docker-compose.yml',
                        hours: 4,
                        codeExample: 'docker-setup'
                    },
                    {
                        name: 'Configure CI/CD pipeline',
                        description: 'Setup GitHub Actions for automated testing',
                        hours: 3,
                        codeExample: 'github-actions'
                    },
                    {
                        name: 'Initialize PostgreSQL database',
                        description: 'Setup database schema and migrations',
                        hours: 3,
                        codeExample: 'postgres-setup'
                    },
                    {
                        name: 'Setup Redis caching',
                        description: 'Configure Redis for caching and queues',
                        hours: 2,
                        codeExample: 'redis-setup'
                    },
                    {
                        name: 'Configure environment variables',
                        description: 'Setup .env files and configuration management',
                        hours: 2,
                        codeExample: 'env-config'
                    },
                    {
                        name: 'Setup monitoring infrastructure',
                        description: 'Configure logging and monitoring',
                        hours: 4,
                        codeExample: 'monitoring-setup'
                    },
                    {
                        name: 'Create development documentation',
                        description: 'Write comprehensive README and setup guides',
                        hours: 4,
                        codeExample: 'documentation'
                    }
                ]
            },
            'scraping': {
                title: 'Web Scraping Engine',
                description: 'Build the core web scraping engine with anti-detection capabilities',
                phase: 1,
                priority: 'Critical',
                estimatedHours: 36,
                dependencies: ['Development Environment'],
                tasks: [
                    {
                        name: 'Implement Selenium WebDriver integration',
                        description: 'Setup Selenium with Chrome for dynamic content scraping',
                        hours: 4,
                        codeExample: 'selenium-setup'
                    },
                    {
                        name: 'Setup Playwright integration',
                        description: 'Configure Playwright for modern web scraping',
                        hours: 4,
                        codeExample: 'playwright-setup'
                    },
                    {
                        name: 'Build proxy rotation system',
                        description: 'Implement proxy management for scale',
                        hours: 6,
                        codeExample: 'proxy-rotation'
                    },
                    {
                        name: 'Integrate CAPTCHA solving',
                        description: 'Add 2captcha and anti-captcha services',
                        hours: 4,
                        codeExample: 'captcha-solving'
                    },
                    {
                        name: 'Create job queue system',
                        description: 'Build Redis-based job queue for scraping tasks',
                        hours: 4,
                        codeExample: 'job-queue'
                    },
                    {
                        name: 'Implement rate limiting',
                        description: 'Add intelligent rate limiting and delays',
                        hours: 3,
                        codeExample: 'rate-limiting'
                    },
                    {
                        name: 'Build API endpoints',
                        description: 'Create REST API for scraping operations',
                        hours: 5,
                        codeExample: 'api-endpoints'
                    },
                    {
                        name: 'Add error handling',
                        description: 'Comprehensive error handling and retry logic',
                        hours: 3,
                        codeExample: 'error-handling'
                    },
                    {
                        name: 'Create data validation pipeline',
                        description: 'Validate and clean scraped data',
                        hours: 2,
                        codeExample: 'data-validation'
                    },
                    {
                        name: 'Setup browser fingerprinting',
                        description: 'Randomize browser fingerprints for stealth',
                        hours: 1,
                        codeExample: 'fingerprinting'
                    }
                ]
            },
            'ai': {
                title: 'AI Integration Layer',
                description: 'Integrate multiple AI providers for intelligent data extraction',
                phase: 1,
                priority: 'High',
                estimatedHours: 32,
                dependencies: ['Development Environment'],
                tasks: [
                    {
                        name: 'Integrate OpenAI GPT-4',
                        description: 'Setup OpenAI API integration',
                        hours: 3,
                        codeExample: 'openai-integration'
                    },
                    {
                        name: 'Integrate Anthropic Claude',
                        description: 'Setup Claude API integration',
                        hours: 3,
                        codeExample: 'claude-integration'
                    },
                    {
                        name: 'Integrate Google Gemini',
                        description: 'Setup Gemini API integration',
                        hours: 3,
                        codeExample: 'gemini-integration'
                    },
                    {
                        name: 'Setup local Ollama',
                        description: 'Configure Ollama for local AI processing',
                        hours: 4,
                        codeExample: 'ollama-setup'
                    },
                    {
                        name: 'Build provider routing',
                        description: 'Smart routing between AI providers',
                        hours: 5,
                        codeExample: 'provider-routing'
                    },
                    {
                        name: 'Implement response caching',
                        description: 'Cache AI responses to reduce costs',
                        hours: 3,
                        codeExample: 'ai-caching'
                    },
                    {
                        name: 'Create cost tracking',
                        description: 'Track AI usage and costs',
                        hours: 3,
                        codeExample: 'cost-tracking'
                    },
                    {
                        name: 'Build prompt templates',
                        description: 'Create optimized prompt templates',
                        hours: 4,
                        codeExample: 'prompt-templates'
                    },
                    {
                        name: 'Add response validation',
                        description: 'Validate AI responses for quality',
                        hours: 2,
                        codeExample: 'response-validation'
                    },
                    {
                        name: 'Implement fallback mechanisms',
                        description: 'Fallback logic for AI provider failures',
                        hours: 2,
                        codeExample: 'ai-fallbacks'
                    }
                ]
            },
            'frontend': {
                title: 'Frontend Dashboard',
                description: 'Build a modern React dashboard for managing scraping jobs',
                phase: 1,
                priority: 'High',
                estimatedHours: 40,
                dependencies: ['Development Environment', 'Web Scraping Engine'],
                tasks: [
                    {
                        name: 'Setup React project',
                        description: 'Initialize React app with TypeScript',
                        hours: 3,
                        codeExample: 'react-setup'
                    },
                    {
                        name: 'Implement responsive layout',
                        description: 'Create mobile-first responsive design',
                        hours: 5,
                        codeExample: 'responsive-layout'
                    },
                    {
                        name: 'Create job management UI',
                        description: 'Build interfaces for managing scraping jobs',
                        hours: 6,
                        codeExample: 'job-management'
                    },
                    {
                        name: 'Build WebSocket integration',
                        description: 'Real-time updates via WebSockets',
                        hours: 4,
                        codeExample: 'websocket-integration'
                    },
                    {
                        name: 'Develop analytics components',
                        description: 'Charts and analytics for scraping data',
                        hours: 5,
                        codeExample: 'analytics-components'
                    },
                    {
                        name: 'Implement authentication',
                        description: 'User authentication and authorization',
                        hours: 5,
                        codeExample: 'auth-implementation'
                    },
                    {
                        name: 'Create settings panels',
                        description: 'User settings and configuration UI',
                        hours: 3,
                        codeExample: 'settings-panels'
                    },
                    {
                        name: 'Add theme support',
                        description: 'Dark/light theme switching',
                        hours: 2,
                        codeExample: 'theme-support'
                    },
                    {
                        name: 'Build notification system',
                        description: 'In-app notifications and alerts',
                        hours: 3,
                        codeExample: 'notification-system'
                    },
                    {
                        name: 'Implement PWA features',
                        description: 'Progressive Web App functionality',
                        hours: 4,
                        codeExample: 'pwa-features'
                    }
                ]
            }
        };

        // Code examples database
        const codeExamples = {
            'repository-structure': {
                title: 'Repository Structure Setup',
                description: 'Create a well-organized project structure for the Ultimate Scraper',
                examples: [
                    {
                        language: 'bash',
                        code: `# Initialize the repository
mkdir ultimate-scraper
cd ultimate-scraper
git init

# Create main directories
mkdir -p {backend/{src/{api,models,services,utils},tests,config},frontend/{src/{components,pages,hooks,utils},public},docker,docs,scripts}

# Create initial files
touch backend/requirements.txt
touch backend/.env.example
touch frontend/package.json
touch docker/Dockerfile.backend
touch docker/Dockerfile.frontend
touch docker/docker-compose.yml
touch README.md
touch .gitignore

echo "Repository structure created successfully!"
ls -la`
                    }
                ]
            },
            'docker-setup': {
                title: 'Docker Configuration',
                description: 'Complete Docker setup for development and production',
                examples: [
                    {
                        language: 'dockerfile',
                        code: `# docker/Dockerfile.backend
FROM python:3.11-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \\
    chromium \\
    chromium-driver \\
    && rm -rf /var/lib/apt/lists/*

# Copy requirements first for better caching
COPY backend/requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY backend/ .

# Set environment variables
ENV PYTHONPATH=/app
ENV CHROMIUM_PATH=/usr/bin/chromium

EXPOSE 8000

CMD ["uvicorn", "src.main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]`
                    }
                ]
            },
            'selenium-setup': {
                title: 'Selenium WebDriver Configuration',
                description: 'Advanced Selenium setup with anti-detection features',
                examples: [
                    {
                        language: 'python',
                        code: `# backend/src/services/selenium_service.py
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import undetected_chromedriver as uc
import random
import time

class StealthWebDriver:
    def __init__(self, proxy=None, headless=True):
        self.options = Options()
        self.setup_stealth_options()
        if headless:
            self.options.add_argument('--headless')
        if proxy:
            self.options.add_argument(f'--proxy-server={proxy}')
        
        # Use undetected_chromedriver for better stealth
        self.driver = uc.Chrome(options=self.options)
        self.wait = WebDriverWait(self.driver, 10)
    
    def setup_stealth_options(self):
        """Configure Chrome options for stealth mode"""
        # Disable automation indicators
        self.options.add_experimental_option("excludeSwitches", ["enable-automation"])
        self.options.add_experimental_option('useAutomationExtension', False)
        
        # Randomize window size
        width = random.randint(1024, 1920)
        height = random.randint(768, 1080)
        self.options.add_argument(f'--window-size={width},{height}')
        
        # Additional stealth arguments
        self.options.add_argument('--no-sandbox')
        self.options.add_argument('--disable-blink-features=AutomationControlled')
        self.options.add_argument('--disable-dev-shm-usage')
        self.options.add_argument('--disable-extensions')
        self.options.add_argument('--disable-gpu')
        
        # Randomize user agent
        user_agents = [
            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
            'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36'
        ]
        self.options.add_argument(f'--user-agent={random.choice(user_agents)}')
    
    def human_like_delay(self, min_delay=1, max_delay=3):
        """Add human-like delays between actions"""
        time.sleep(random.uniform(min_delay, max_delay))
    
    def scrape_page(self, url, selectors):
        """Scrape data from a page with intelligent waiting"""
        try:
            self.driver.get(url)
            self.human_like_delay()
            
            # Execute stealth script
            self.driver.execute_script("""
                Object.defineProperty(navigator, 'webdriver', {
                    get: () => undefined,
                });
            """)
            
            data = {}
            for name, selector in selectors.items():
                try:
                    element = self.wait.until(
                        EC.presence_of_element_located((By.CSS_SELECTOR, selector))
                    )
                    data[name] = element.text.strip()
                    self.human_like_delay(0.5, 1.5)
                except:
                    data[name] = None
            
            return data
        except Exception as e:
            print(f"Error scraping {url}: {e}")
            return None
    
    def close(self):
        """Clean up the driver"""
        if self.driver:
            self.driver.quit()`
                    }
                ]
            }
        };

        // Enhanced AI Response System (No Demo Labels)
        class SmartAIResponseSystem {
            constructor() {
                this.currentModel = AppState.ai.currentModel;
                this.taskAnalyzer = new TaskAnalyzer();
            }

            generateResponse(userMessage) {
                const model = AppState.ai.models[this.currentModel];
                const lowerMessage = userMessage.toLowerCase();

                // Handle weather queries with integration guidance
                if (lowerMessage.includes('weather') && lowerMessage.includes('chicago')) {
                    return this.getWeatherWithIntegrationAdvice();
                }

                // Handle GitHub/HubSpot integration questions
                if (lowerMessage.includes('github') || lowerMessage.includes('hubspot')) {
                    return this.getIntegrationGuidance(lowerMessage);
                }

                // Handle progress analysis requests
                if (lowerMessage.includes('progress') || lowerMessage.includes('analysis')) {
                    return this.getProgressAnalysis();
                }

                // Handle task recommendations
                if (lowerMessage.includes('next') || lowerMessage.includes('recommend')) {
                    return this.getTaskRecommendations();
                }

                // Handle code help requests
                if (lowerMessage.includes('code') || lowerMessage.includes('example')) {
                    return this.getCodeGuidance(lowerMessage);
                }

                // Handle analytics requests
                if (lowerMessage.includes('analytics') || lowerMessage.includes('report')) {
                    return this.getAnalyticsGuidance();
                }

                // Handle project questions with smart context
                if (this.isProjectQuestion(lowerMessage)) {
                    return this.getSmartProjectResponse(lowerMessage);
                }

                // Default responses with project awareness (NO DEMO LABELS)
                return this.getContextualResponse(lowerMessage);
            }

            getWeatherWithIntegrationAdvice() {
                return `I'd need to search the web for current Chicago weather. However, I notice you haven't connected your GitHub repository yet! Once connected, I could help you build a weather scraping module for your Ultimate Scraper. Would you like me to guide you through setting up GitHub integration first?`;
            }

            getIntegrationGuidance(message) {
                const isGitHub = message.includes('github');
                const isHubSpot = message.includes('hubspot');
                
                if (isGitHub && !AppState.integrations.github.connected) {
                    return `To connect GitHub: Click 'Connect GitHub' in settings, then provide your repository URL, personal access token, and username. This enables commit tracking and repository-specific code examples!`;
                }
                
                if (isHubSpot && !AppState.integrations.hubspot.connected) {
                    return `For HubSpot integration: Click 'Connect HubSpot' in settings, then enter your Portal ID, private app access token, and account name. This syncs your project progress with HubSpot deals!`;
                }
                
                return "I can help you set up either GitHub or HubSpot integration. Which one would you like to configure first?";
            }

            getProgressAnalysis() {
                const progress = AppState.progress.overall;
                const completed = AppState.progress.completed;
                const total = AppState.progress.total;
                
                return `ðŸ“Š **Progress Analysis**: You're at ${progress}% completion (${completed}/${total} tasks). Based on your analytics dashboard, I recommend focusing on the Development Environment next - it's blocking 3 other critical tasks. Your systematic approach is excellent for a 36-month timeline!`;
            }

            getTaskRecommendations() {
                const nextTask = this.taskAnalyzer.getNextRecommendedTask();
                
                return `ðŸŽ¯ **Smart Recommendation**: Start with "${nextTask.name}" in ${nextTask.project}. Based on your analytics, this has the highest impact-to-effort ratio. I can show you code examples - just ask!`;
            }

            getCodeGuidance(message) {
                const currentProject = this.taskAnalyzer.getCurrentProject();
                return `ðŸ’» I can provide code examples for ${currentProject}! Try: "Show me Docker setup code" or "How to implement Selenium stealth mode". I have examples for repository structure, API endpoints, AI integration, and more. What specific code would help you most?`;
            }

            getAnalyticsGuidance() {
                return `ðŸ“ˆ **Analytics Available**: Your dashboard shows productivity scores, velocity trends, and AI usage patterns. You're most productive 9-11 AM with 95% completion rate on dev tasks. Click "Analytics Report" for detailed insights!`;
            }

            getSmartProjectResponse(message) {
                const progress = AppState.progress.overall;
                
                const contextualAdvice = progress === 0 ? 
                    "Start with development environment - it's the foundation for everything else." :
                    progress < 25 ? 
                    `Great foundation work! Your analytics show strong velocity on setup tasks.` :
                    "Excellent momentum! You're building something impressive.";
                
                return `Your Ultimate Scraper is ${progress}% complete. ${contextualAdvice} I'm analyzing your dependency chain and can provide specific code examples. What aspect would you like to tackle next?`;
            }

            getContextualResponse(message) {
                const hasIntegrations = AppState.integrations.github.connected || AppState.integrations.hubspot.connected;
                
                const integrationHint = !hasIntegrations ? 
                    " Pro tip: Connect GitHub to unlock code examples and progress tracking!" : "";
                
                return `I'm here to help with your Ultimate Scraper project! I can analyze your progress, suggest next tasks, provide code examples, and guide you through integrations.${integrationHint} What would you like to work on?`;
            }

            isProjectQuestion(message) {
                return ['project', 'scraper', 'development', 'task', 'phase', 'roadmap', 'build', 'ultimate'].some(keyword => 
                    message.includes(keyword)
                );
            }
        }

        // Task Analysis System
        class TaskAnalyzer {
            getNextRecommendedTask() {
                for (const [projectId, project] of Object.entries(projectData)) {
                    const completed = getCompletedTasksCount(projectId);
                    if (completed < project.tasks.length) {
                        return {
                            name: project.tasks[completed].name,
                            project: project.title,
                            description: project.tasks[completed].description
                        };
                    }
                }
                return { name: 'All tasks complete!', project: 'Ultimate Scraper', description: 'Amazing work!' };
            }

            getCurrentProject() {
                return Object.keys(projectData)[0] || 'Development Environment';
            }
        }

        const smartAISystem = new SmartAIResponseSystem();

        // Custom Plugin System Functions
        function installCustomPlugin() {
            const codeInput = document.getElementById('pluginCodeInput');
            const code = codeInput.value.trim();
            
            if (!code) {
                showNotification('Please paste HTML/CSS/JS code first', 'error');
                return;
            }

            try {
                // Create a unique plugin ID
                const pluginId = 'plugin_' + Date.now();
                
                // Create plugin container
                const pluginContainer = document.createElement('div');
                pluginContainer.id = pluginId;
                pluginContainer.innerHTML = code;
                
                // Add to page
                document.body.appendChild(pluginContainer);
                
                // Save plugin
                const plugin = {
                    id: pluginId,
                    name: `Custom Plugin ${AppState.customPlugins.length + 1}`,
                    code: code,
                    installed: new Date().toISOString()
                };
                
                AppState.customPlugins.push(plugin);
                localStorage.setItem('custom_plugins', JSON.stringify(AppState.customPlugins));
                
                // Update UI
                updateCustomPluginsUI();
                codeInput.value = '';
                
                showNotification('Custom plugin installed successfully!', 'success');
                addChatMessage(`ðŸ”§ Installed custom plugin with ${code.length} characters of code. New functionality is now active!`, 'system');
                
            } catch (error) {
                showNotification('Error installing plugin: ' + error.message, 'error');
            }
        }

        function clearPluginCode() {
            document.getElementById('pluginCodeInput').value = '';
        }

        function removeCustomPlugin(pluginId) {
            // Remove from DOM
            const element = document.getElementById(pluginId);
            if (element) {
                element.remove();
            }
            
            // Remove from state
            AppState.customPlugins = AppState.customPlugins.filter(p => p.id !== pluginId);
            localStorage.setItem('custom_plugins', JSON.stringify(AppState.customPlugins));
            
            updateCustomPluginsUI();
            showNotification('Plugin removed', 'info');
        }

        function updateCustomPluginsUI() {
            const container = document.getElementById('customPluginsList');
            container.innerHTML = '';
            
            if (AppState.customPlugins.length === 0) {
                container.innerHTML = '<div style="color: var(--text-secondary); font-size: 12px; text-align: center; padding: 20px;">No custom plugins installed</div>';
                return;
            }
            
            AppState.customPlugins.forEach(plugin => {
                const pluginDiv = document.createElement('div');
                pluginDiv.className = 'plugin-item';
                pluginDiv.innerHTML = `
                    <div class="plugin-info">
                        <div class="plugin-name">${plugin.name}</div>
                        <div class="plugin-description">Installed ${new Date(plugin.installed).toLocaleDateString()}</div>
                    </div>
                    <button class="plugin-btn" onclick="removeCustomPlugin('${plugin.id}')" style="background: var(--error);">Remove</button>
                `;
                container.appendChild(pluginDiv);
            });
        }

        // Authentication Functions
        function showGitHubAuth() {
            document.getElementById('githubAuthModal').style.display = 'flex';
        }

        function showHubSpotAuth() {
            document.getElementById('hubspotAuthModal').style.display = 'flex';
        }

        function closeAuthModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function authenticateGitHub(event) {
            event.preventDefault();
            
            const repo = document.getElementById('githubRepo').value;
            const token = document.getElementById('githubToken').value;
            const username = document.getElementById('githubUsername').value;
            
            showNotification('Connecting to GitHub...', 'info');
            
            setTimeout(() => {
                AppState.integrations.github = {
                    connected: true,
                    repo: repo,
                    token: token,
                    username: username,
                    lastSync: new Date()
                };
                
                updateConnectionStatus();
                updateIntegrationStatus();
                closeAuthModal('githubAuthModal');
                
                showNotification('GitHub connected successfully!', 'success');
                addChatMessage(`ðŸ”— GitHub connected to ${repo}! I can now provide repository-specific code examples and track commits.`, 'system');
            }, 2000);
        }

        function authenticateHubSpot(event) {
            event.preventDefault();
            
            const portal = document.getElementById('hubspotPortal').value;
            const token = document.getElementById('hubspotToken').value;
            const account = document.getElementById('hubspotAccount').value;
            
            showNotification('Connecting to HubSpot...', 'info');
            
            setTimeout(() => {
                AppState.integrations.hubspot = {
                    connected: true,
                    portal: portal,
                    token: token,
                    account: account,
                    deals: 47,
                    lastSync: new Date()
                };
                
                updateConnectionStatus();
                updateIntegrationStatus();
                closeAuthModal('hubspotAuthModal');
                
                showNotification(`HubSpot connected! 47 deals synced from ${account}.`, 'success');
                addChatMessage(`ðŸ“Š HubSpot connected to ${account}! I can now sync your project progress with deals and opportunities.`, 'system');
            }, 2000);
        }

        function updateIntegrationStatus() {
            const githubStatus = document.getElementById('githubConnectionStatus');
            const hubspotStatus = document.getElementById('hubspotConnectionStatus');
            
            if (AppState.integrations.github.connected) {
                githubStatus.textContent = `Connected to ${AppState.integrations.github.repo}`;
                githubStatus.style.color = 'var(--success)';
            }
            
            if (AppState.integrations.hubspot.connected) {
                hubspotStatus.textContent = `Connected to ${AppState.integrations.hubspot.account}`;
                hubspotStatus.style.color = 'var(--success)';
            }
        }

        // Analytics Functions
        function generateAnalyticsReport() {
            const progress = AppState.progress.overall;
            const completed = AppState.progress.completed;
            
            addChatMessage(`ðŸ“Š **Analytics Report Generated**

**Project Status:**
â€¢ Overall Progress: ${progress}%
â€¢ Tasks Completed: ${completed}/38
â€¢ Current Phase: Foundation Setup

**Productivity Insights:**
â€¢ Peak productivity: 9-11 AM (2.3x more tasks)
â€¢ Best completion rate: Development tasks (95%)
â€¢ Recommended focus: Docker setup (unlocks 4 tasks)
â€¢ Velocity trend: Building momentum

**AI Usage:**
â€¢ GPT-4: 85% of interactions
â€¢ Average response time: 1.2s
â€¢ Cost optimization: 92% efficient

**Next Actions:**
1. Complete Development Environment setup
2. Connect GitHub for better tracking
3. Focus on morning work sessions`, 'assistant');
            
            showNotification('Analytics report generated in chat', 'success');
        }

        function refreshAnalytics() {
            const charts = ['velocityChart', 'progressChart', 'aiUsageChart', 'productivityChart'];
            
            charts.forEach(chartId => {
                const chart = document.getElementById(chartId);
                chart.style.opacity = '0.5';
                chart.innerHTML = 'ðŸ”„ Refreshing...';
            });
            
            setTimeout(() => {
                document.getElementById('velocityChart').innerHTML = 'ðŸ“ˆ Velocity trending upward<br><small>3.5 tasks/week average (+0.3)</small>';
                document.getElementById('progressChart').innerHTML = 'ðŸ¥§ Phase 1: 0% | Phase 2-4: Locked<br><small>Foundation phase active</small>';
                document.getElementById('aiUsageChart').innerHTML = 'ðŸ¤– GPT-4: 82% | Claude: 18%<br><small>Multi-model optimization</small>';
                document.getElementById('productivityChart').innerHTML = 'â­ 8.7/10 Productivity Score<br><small>Above average performance (+0.2)</small>';
                
                charts.forEach(chartId => {
                    document.getElementById(chartId).style.opacity = '1';
                });
                
                document.getElementById('analyticsInsights').innerHTML = `
                    â€¢ You're most productive between 9-11 AM (complete 2.5x more tasks)<br>
                    â€¢ Development Environment tasks have highest completion rate (97%)<br>
                    â€¢ Recommended: Focus on Docker setup next - it unlocks 4 dependent tasks<br>
                    â€¢ GitHub integration would increase velocity by estimated 45%<br>
                    â€¢ Custom plugins show 15% productivity boost
                `;
                
                showNotification('Analytics refreshed', 'success');
            }, 2000);
        }

        // Fixed: Show Next Task Code Examples
        function showNextTaskCode() {
            const nextTask = smartAISystem.taskAnalyzer.getNextRecommendedTask();
            const projectId = Object.keys(projectData)[0]; // Get first project
            const project = projectData[projectId];
            const taskIndex = getCompletedTasksCount(projectId);
            
            if (taskIndex < project.tasks.length) {
                const task = project.tasks[taskIndex];
                if (task.codeExample && codeExamples[task.codeExample]) {
                    showCodeExample(task.codeExample);
                } else {
                    showNotification('Code example coming soon for this task!', 'info');
                }
            } else {
                showNotification('All tasks in this project are complete!', 'success');
            }
        }

        // Task Detail Modal Functions
        function openTaskDetails(projectId) {
            const project = projectData[projectId];
            if (!project) return;

            AppState.currentTask = projectId;
            
            // Update modal content
            document.getElementById('taskDetailTitle').textContent = project.title;
            document.getElementById('taskHours').textContent = `${project.estimatedHours}h`;
            document.getElementById('taskPriority').textContent = project.priority;
            document.getElementById('taskDependencies').textContent = project.dependencies.length > 0 ? project.dependencies.join(', ') : 'None';
            
            // Calculate progress
            const completed = getCompletedTasksCount(projectId);
            const total = project.tasks.length;
            const progressPercent = total > 0 ? Math.round((completed / total) * 100) : 0;
            document.getElementById('taskProgress').textContent = `${progressPercent}%`;
            
            // Populate subtasks
            const subtasksList = document.getElementById('subtasksList');
            subtasksList.innerHTML = '';
            
            project.tasks.forEach((task, index) => {
                const isCompleted = completed > index;
                const subtaskDiv = document.createElement('div');
                subtaskDiv.className = 'subtask-item';
                subtaskDiv.innerHTML = `
                    <div class="subtask-checkbox ${isCompleted ? 'completed' : ''}" onclick="toggleSubtask('${projectId}', ${index})">
                        ${isCompleted ? 'âœ“' : ''}
                    </div>
                    <div class="subtask-details">
                        <div class="subtask-name">${task.name}</div>
                        <div class="subtask-description">${task.description}</div>
                    </div>
                    <div class="subtask-hours">${task.hours}h</div>
                `;
                subtasksList.appendChild(subtaskDiv);
            });
            
            // Show modal
            document.getElementById('taskDetailModal').style.display = 'flex';
        }

        function closeTaskModal() {
            document.getElementById('taskDetailModal').style.display = 'none';
            AppState.currentTask = null;
        }

        function toggleSubtask(projectId, taskIndex) {
            const currentProgress = JSON.parse(localStorage.getItem('project_progress') || '{}');
            if (!currentProgress[projectId]) {
                currentProgress[projectId] = [];
            }
            
            // Can only complete tasks in order
            if (taskIndex === currentProgress[projectId].length) {
                currentProgress[projectId].push({
                    taskIndex: taskIndex,
                    completedAt: new Date().toISOString()
                });
                
                localStorage.setItem('project_progress', JSON.stringify(currentProgress));
                
                const project = projectData[projectId];
                const task = project.tasks[taskIndex];
                showNotification(`Completed: ${task.name}`, 'success');
                
                updateAllProgress();
                updateAIGuidance();
                
                // Refresh modal
                setTimeout(() => openTaskDetails(projectId), 500);
            }
        }

        function startTask() {
            if (!AppState.currentTask) return;
            
            const project = projectData[AppState.currentTask];
            addChatMessage(`ðŸš€ Started working on "${project.title}". I'm here to help with code examples and guidance!`, 'system');
            closeTaskModal();
        }

        function completeTask() {
            if (!AppState.currentTask) return;
            
            const project = projectData[AppState.currentTask];
            const completed = getCompletedTasksCount(AppState.currentTask);
            const total = project.tasks.length;
            
            if (completed === total) {
                showNotification(`${project.title} already completed!`, 'info');
                return;
            }
            
            // Complete the next task
            const currentProgress = JSON.parse(localStorage.getItem('project_progress') || '{}');
            if (!currentProgress[AppState.currentTask]) {
                currentProgress[AppState.currentTask] = [];
            }
            
            currentProgress[AppState.currentTask].push({
                taskIndex: completed,
                completedAt: new Date().toISOString()
            });
            
            localStorage.setItem('project_progress', JSON.stringify(currentProgress));
            
            const task = project.tasks[completed];
            showNotification(`Completed: ${task.name}`, 'success');
            addChatMessage(`âœ… Marked "${task.name}" as complete in ${project.title}`, 'system');
            
            updateAllProgress();
            updateAIGuidance();
            
            // Refresh modal
            setTimeout(() => openTaskDetails(AppState.currentTask), 500);
        }

        function showTaskCode() {
            if (!AppState.currentTask) return;
            
            const project = projectData[AppState.currentTask];
            const completed = getCompletedTasksCount(AppState.currentTask);
            
            if (completed < project.tasks.length) {
                const task = project.tasks[completed];
                if (task.codeExample && codeExamples[task.codeExample]) {
                    showCodeExample(task.codeExample);
                } else {
                    showNotification('Code example coming soon!', 'info');
                }
            }
        }

        function showCodeExample(exampleKey) {
            const example = codeExamples[exampleKey];
            if (!example) {
                showNotification('Code example not found', 'error');
                return;
            }

            const modal = document.getElementById('codeModal');
            const title = document.getElementById('codeTitle');
            const content = document.getElementById('codeContent');

            title.textContent = example.title;
            
            let html = `<p style="margin-bottom: 15px; color: var(--text-secondary);">${example.description}</p>`;
            
            example.examples.forEach((ex, index) => {
                html += `
                    <div style="margin-bottom: 20px;">
                        <div class="code-language">${ex.language.toUpperCase()}</div>
                        <div class="code-block">${ex.code}</div>
                    </div>
                `;
            });

            content.innerHTML = html;
            modal.style.display = 'flex';
        }

        function closeCodeModal() {
            document.getElementById('codeModal').style.display = 'none';
        }

        function updateConnectionStatus() {
            const githubDot = document.getElementById('githubStatusDot');
            const githubText = document.getElementById('githubStatusText');
            if (AppState.integrations.github.connected) {
                githubDot.className = 'connection-status-dot status-connected';
                githubText.textContent = `GitHub: Connected to ${AppState.integrations.github.repo}`;
            }

            const hubspotDot = document.getElementById('hubspotStatusDot');
            const hubspotText = document.getElementById('hubspotStatusText');
            if (AppState.integrations.hubspot.connected) {
                hubspotDot.className = 'connection-status-dot status-connected';
                hubspotText.textContent = `HubSpot: ${AppState.integrations.hubspot.deals} deals synced`;
            }

            const lastSync = Math.max(
                AppState.integrations.github.lastSync?.getTime() || 0,
                AppState.integrations.hubspot.lastSync?.getTime() || 0
            );
            if (lastSync > 0) {
                document.getElementById('lastSyncTime').textContent = new Date(lastSync).toLocaleTimeString();
            }
        }

        // Update AI Guidance Panel
        function updateAIGuidance() {
            const progress = AppState.progress.overall;
            const completed = AppState.progress.completed;
            const total = AppState.progress.total;
            
            const guidanceText = document.getElementById('aiGuidanceText');
            const nextTaskElement = document.getElementById('nextTaskSuggestion');
            
            if (progress === 0) {
                guidanceText.textContent = `ðŸš€ Ready to analyze your Ultimate Scraper project! Based on your current ${progress}% completion, I recommend starting with the Development Environment setup - it's critical for all future tasks.`;
                nextTaskElement.textContent = 'Development Environment Setup - Create repository structure';
            } else {
                const nextTask = smartAISystem.taskAnalyzer.getNextRecommendedTask();
                guidanceText.textContent = `ðŸ“ˆ Great progress! You're ${progress}% complete (${completed}/${total} tasks). Based on your dependency analysis, focus on ${nextTask.project} next.`;
                nextTaskElement.textContent = `${nextTask.name} - ${nextTask.description}`;
            }

            const velocityTrend = document.getElementById('velocityTrend');
            const progressInsight = document.getElementById('progressInsight');
            
            if (completed === 0) {
                velocityTrend.textContent = 'Starting Phase';
                progressInsight.textContent = 'Complete 3 tasks to establish baseline velocity';
            } else if (completed < 5) {
                velocityTrend.textContent = 'Building Momentum';
                progressInsight.textContent = 'Excellent start! Dependency chain is optimized';
            } else {
                velocityTrend.textContent = 'Strong Velocity';
                progressInsight.textContent = 'Outstanding progress! On track for 36-month timeline';
            }
        }

        // Enhanced LLM Management Functions (NO DEMO LABELS)
        function changeLLM() {
            const selector = document.getElementById('llmSelector');
            const selectedModel = selector.value;
            AppState.ai.currentModel = selectedModel;
            localStorage.setItem('selectedLLM', selectedModel);
            
            updateLLMUI(selectedModel);
            updateChatHeader(selectedModel);
            
            smartAISystem.currentModel = selectedModel;
            
            const model = AppState.ai.models[selectedModel];
            addChatMessage(`ðŸ”„ Switched to ${model.name}`, 'system');
            
            // Professional welcome message (NO DEMO LABELS)
            const welcomeMessage = `Hello! I'm now using ${model.name} to help with your Ultimate Scraper project. I can analyze your progress, suggest next tasks, and provide code examples. How can I assist you?`;
            
            addChatMessage(welcomeMessage, 'assistant');
            showNotification(`Switched to ${model.name}`, 'success');
        }

        function updateLLMUI(modelKey) {
            const model = AppState.ai.models[modelKey];
            const statusDiv = document.getElementById('llmStatus');
            const activeAICard = document.getElementById('activeAI');
            
            const statusText = modelKey === 'ollama' ? 'Local' : 'Active';
            statusDiv.innerHTML = `
                <div class="llm-icon" style="background: ${model.color};"></div>
                <span>${model.name.replace(' (Local)', '')} ${statusText}</span>
            `;
            
            statusDiv.className = modelKey === 'ollama' ? 'llm-status local' : 'llm-status connected';
            
            if (activeAICard) {
                activeAICard.textContent = model.name.split(' ').pop();
            }
        }

        function updateChatHeader(modelKey) {
            const model = AppState.ai.models[modelKey];
            const indicator = document.getElementById('chatAiIndicator');
            
            indicator.innerHTML = `
                <div class="llm-icon" style="background: ${model.color}; width: 12px; height: 12px;"></div>
                <span>${model.name.split(' ').pop()}</span>
            `;
        }

        // Enhanced Chat Functions
        function initializeChat() {
            const messagesDiv = document.getElementById('chatMessages');
            if (messagesDiv.children.length === 0) {
                const model = AppState.ai.models[AppState.ai.currentModel];
                const welcomeMessage = `Hello! I'm ready to help with your Ultimate Scraper project using ${model.name}. I can analyze your progress, suggest next tasks, provide code examples, and guide you through GitHub/HubSpot integration. What would you like to work on?`;
                
                addChatMessage(welcomeMessage, 'assistant');
            }
        }

        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            const chatIcon = document.getElementById('chatIcon');
            const isActive = chatWindow.classList.contains('active');
            
            if (isActive) {
                chatWindow.classList.remove('active');
                chatIcon.textContent = 'ðŸ’¬';
            } else {
                chatWindow.classList.add('active');
                chatIcon.textContent = 'Ã—';
                document.getElementById('chatInput').focus();
            }
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const sendBtn = document.getElementById('chatSend');
            sendBtn.disabled = true;
            
            addChatMessage(message, 'user');
            input.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                const response = smartAISystem.generateResponse(message);
                addChatMessage(response, 'assistant');
                sendBtn.disabled = false;
            }, Math.random() * 2000 + 1000);
        }

        function addChatMessage(message, sender) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            messageDiv.innerHTML = message;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function showTypingIndicator() {
            const messagesDiv = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-message typing';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <span>AI is analyzing</span>
                <div class="typing-indicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            messagesDiv.appendChild(typingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Project Management Functions (Enhanced)
        function getCompletedTasksCount(projectId) {
            const currentProgress = JSON.parse(localStorage.getItem('project_progress') || '{}');
            return currentProgress[projectId] ? currentProgress[projectId].length : 0;
        }

        function updateAllProgress() {
            updateProjectProgress();
            updateOverallProgress();
            updatePhaseProgress();
        }

        function updateProjectProgress() {
            Object.keys(projectData).forEach(projectId => {
                const project = projectData[projectId];
                const completed = getCompletedTasksCount(projectId);
                const total = project.tasks.length;
                const progressElement = document.getElementById(`progress-${projectId}`);
                
                if (progressElement) {
                    progressElement.textContent = `${completed}/${total} tasks`;
                }
                
                const statusElement = document.getElementById(`status-${projectId}`);
                if (statusElement) {
                    if (completed === total) {
                        statusElement.className = 'project-status status-completed';
                        statusElement.textContent = 'âœ“';
                    } else if (completed > 0) {
                        statusElement.className = 'project-status status-in-progress';
                        statusElement.textContent = 'â—';
                    } else {
                        statusElement.className = 'project-status status-not-started';
                        statusElement.textContent = 'â—‹';
                    }
                }
            });
        }

        function updateOverallProgress() {
            let totalTasks = 0;
            let completedTasks = 0;
            
            Object.entries(projectData).forEach(([projectId, project]) => {
                totalTasks += project.tasks.length;
                completedTasks += getCompletedTasksCount(projectId);
            });
            
            const progress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            AppState.progress.overall = progress;
            AppState.progress.completed = completedTasks;
            AppState.progress.total = totalTasks;
            
            document.getElementById('overallProgress').textContent = `${progress}%`;
            document.getElementById('progressPercentage').textContent = `${progress}%`;
            document.getElementById('completedTasks').textContent = `${completedTasks}/${totalTasks}`;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            updateProgressText(progress);
            updateMilestones(progress);
        }

        function updateProgressText(progress) {
            let progressText = '';
            if (progress === 0) {
                progressText = 'ðŸš€ Ready to build Ultimate Scraper! Start working on tasks to track progress.';
            } else if (progress < 25) {
                progressText = `ðŸ”¨ Foundation phase ${progress}% complete - Building core infrastructure!`;
            } else if (progress < 50) {
                progressText = `âš¡ Great progress! ${progress}% complete - Core systems taking shape.`;
            } else if (progress < 75) {
                progressText = `ðŸŽ¯ Amazing work! ${progress}% complete - Advanced features coming together.`;
            } else {
                progressText = `ðŸ† Almost there! ${progress}% complete - Ultimate Scraper nearly ready!`;
            }
            
            document.getElementById('progressText').textContent = progressText;
        }

        function updatePhaseProgress() {
            const phases = {};
            
            Object.entries(projectData).forEach(([projectId, project]) => {
                if (!phases[project.phase]) {
                    phases[project.phase] = { total: 0, completed: 0 };
                }
                
                phases[project.phase].total += project.tasks.length;
                phases[project.phase].completed += getCompletedTasksCount(projectId);
            });
            
            Object.entries(phases).forEach(([phase, data]) => {
                const progress = data.total > 0 ? Math.round((data.completed / data.total) * 100) : 0;
                const progressBar = document.getElementById(`phase${phase}Progress`);
                const progressText = document.getElementById(`phase${phase}Text`);
                
                if (progressBar) progressBar.style.width = `${progress}%`;
                if (progressText) progressText.textContent = `${progress}% Complete`;
                
                AppState.progress.phases[`phase${phase}`] = progress;
            });
        }

        function updateMilestones(progress) {
            const milestones = [
                { id: 'milestone1', threshold: 25 },
                { id: 'milestone2', threshold: 50 },
                { id: 'milestone3', threshold: 75 },
                { id: 'milestone4', threshold: 100 }
            ];

            milestones.forEach(milestone => {
                const element = document.getElementById(milestone.id);
                if (!element) return;

                element.classList.remove('current', 'completed');
                
                if (progress >= milestone.threshold) {
                    element.classList.add('completed');
                } else if (progress >= milestone.threshold - 25) {
                    element.classList.add('current');
                }
            });
        }

        // Theme Management
        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            AppState.settings.theme = theme;
            
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.toggle('active', option.getAttribute('data-theme') === theme);
            });
            
            showNotification(`Theme changed to ${theme}`, 'info');
        }

        // Settings Functions
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.classList.toggle('active');
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            if (!AppState.settings.notifications) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">${type.toUpperCase()}</div>
                <div>${message}</div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Initialize Enhanced Application
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
            
            const savedLLM = localStorage.getItem('selectedLLM') || 'gpt4';
            document.getElementById('llmSelector').value = savedLLM;
            AppState.ai.currentModel = savedLLM;
            updateLLMUI(savedLLM);
            updateChatHeader(savedLLM);
            smartAISystem.currentModel = savedLLM;
            
            // Load custom plugins
            AppState.customPlugins.forEach(plugin => {
                try {
                    const pluginContainer = document.createElement('div');
                    pluginContainer.id = plugin.id;
                    pluginContainer.innerHTML = plugin.code;
                    document.body.appendChild(pluginContainer);
                } catch (error) {
                    console.error('Error loading plugin:', plugin.id, error);
                }
            });
            
            updateAllProgress();
            updateAIGuidance();
            updateConnectionStatus();
            updateCustomPluginsUI();
            updateIntegrationStatus();
            
            initializeChat();
            
            showNotification('Enterprise AI Dashboard ready! Enhanced with custom plugins and integration support.', 'success');
            
            console.log('âœ… MK Processor 4.2.1 Enhanced Enterprise System loaded');
            console.log('ðŸŽ¯ Professional dashboard - immediate access');
            console.log('ðŸ¤– Multi-AI system with enterprise features');
            console.log('ðŸ”§ Custom plugin system and analytics active');
        });

        // Close modals on escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (document.getElementById('settingsPanel').classList.contains('active')) {
                    toggleSettings();
                }
                if (document.getElementById('chatWindow').classList.contains('active')) {
                    toggleChat();
                }
                if (document.getElementById('codeModal').style.display === 'flex') {
                    closeCodeModal();
                }
                if (document.getElementById('taskDetailModal').style.display === 'flex') {
                    closeTaskModal();
                }
                if (document.getElementById('githubAuthModal').style.display === 'flex') {
                    closeAuthModal('githubAuthModal');
                }
                if (document.getElementById('hubspotAuthModal').style.display === 'flex') {
                    closeAuthModal('hubspotAuthModal');
                }
            }
        });

        console.log('âœ… MK Processor 4.2.1 Enterprise Dashboard Complete');
        console.log('ðŸŽ¯ Professional dashboard ready - no login required');
        console.log('ðŸ¤– Enterprise AI system with task management');
        console.log('ðŸ”§ Custom plugin system and analytics active');
        console.log('ðŸ“Š Detailed task breakdown and progress tracking');
        console.log('ðŸ”— GitHub/HubSpot authentication modals ready');
    </script>

<!-- Real-time WebSocket Connection -->
<script>
    let websocket = null;
    let reconnectInterval = null;

    function connectWebSocket() {
        try {
            websocket = new WebSocket('ws://localhost:8000/ws/progress');
            
            websocket.onopen = function(event) {
                console.log('🚀 WebSocket connected to backend!');
                document.getElementById('liveStatusText').textContent = 'Real-time Connected';
                if (reconnectInterval) {
                    clearInterval(reconnectInterval);
                    reconnectInterval = null;
                }
            };

            websocket.onmessage = function(event) {
                try {
                    const data = JSON.parse(event.data);
                    
                    if (data.type === 'progress_update' || data.type === 'initial_connection') {
                        updateDashboardFromWebSocket(data.data);
                    } else if (data.type === 'task_started') {
                        showNotification(`🚀 Started: ${data.task_name}`, 'info');
                    } else if (data.type === 'task_completed') {
                        showNotification(`✅ Completed: ${data.task_name}`, 'success');
                    }
                    
                    document.getElementById('lastSyncTime').textContent = new Date().toLocaleTimeString();
                    
                } catch (error) {
                    console.error('Error parsing WebSocket message:', error);
                }
            };

            websocket.onclose = function(event) {
                console.log('🔌 WebSocket disconnected, attempting to reconnect...');
                document.getElementById('liveStatusText').textContent = 'Reconnecting...';
                
                if (!reconnectInterval) {
                    reconnectInterval = setInterval(connectWebSocket, 3000);
                }
            };

        } catch (error) {
            console.error('Failed to create WebSocket connection:', error);
            setTimeout(connectWebSocket, 5000);
        }
    }

    function updateDashboardFromWebSocket(data) {
        // Update overall progress
        const progressPercentage = data.overall_progress || 0;
        document.getElementById('overallProgress').textContent = `${progressPercentage}%`;
        document.getElementById('progressPercentage').textContent = `${progressPercentage}%`;
        document.getElementById('progressBar').style.width = `${progressPercentage}%`;
        
        // Update completed tasks
        document.getElementById('completedTasks').textContent = `${data.completed_tasks || 0}/${data.total_tasks || 38}`;
        
        // Update current phase
        document.getElementById('currentPhase').textContent = `Phase ${data.current_phase || 1}`;
        
        // Update team velocity
        document.getElementById('teamVelocity').textContent = `${data.team_velocity || 0}`;
        
        // Update progress text based on percentage
        if (progressPercentage === 0) {
            document.getElementById('progressText').textContent = '🚀 Ready to build Ultimate Scraper!';
        } else if (progressPercentage < 25) {
            document.getElementById('progressText').textContent = '🏗️ Foundation phase in progress...';
        } else if (progressPercentage < 50) {
            document.getElementById('progressText').textContent = '⚡ Making great progress!';
        } else if (progressPercentage < 75) {
            document.getElementById('progressText').textContent = '🔥 Over halfway there!';
        } else if (progressPercentage < 100) {
            document.getElementById('progressText').textContent = '🎯 Almost finished!';
        } else {
            document.getElementById('progressText').textContent = '🎉 Project Complete!';
        }
        
        // Update working task indicator
        if (data.current_working_task) {
            document.getElementById('progressInsight').textContent = `Currently working on: ${data.current_working_task}`;
            document.getElementById('velocityTrend').textContent = 'In Progress';
        } else {
            document.getElementById('progressInsight').textContent = 'Ready to start next task';
            document.getElementById('velocityTrend').textContent = 'Available';
        }
    }

    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed; top: 20px; right: 20px; z-index: 10000;
            background: ${type === 'success' ? '#00ff88' : '#007bff'};
            color: white; padding: 12px 24px; border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateX(400px); transition: transform 0.3s ease;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => notification.style.transform = 'translateX(0)', 100);
        setTimeout(() => {
            notification.style.transform = 'translateX(400px)';
            setTimeout(() => document.body.removeChild(notification), 300);
        }, 4000);
    }

    async function simulateProgress() {
        try {
            const response = await fetch('http://localhost:8000/api/simulate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            });
            
            if (response.ok) {
                const result = await response.json();
                showNotification(result.message, 'success');
            }
        } catch (error) {
            showNotification('Connection error', 'error');
        }
    }

    // Initialize WebSocket when page loads
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🔌 Initializing WebSocket connection...');
        connectWebSocket();
        
        // Add simulate button
        const button = document.createElement('button');
        button.textContent = '⚡ Simulate Progress';
        button.className = 'integration-btn';
        button.style.marginLeft = '10px';
        button.onclick = simulateProgress;
        
        const analyticsHeader = document.querySelector('.analytics-header');
        if (analyticsHeader) {
            analyticsHeader.appendChild(button);
        }
        
        showNotification('🚀 MK Processor 4.2.1 - Connecting to real-time backend...', 'info');
    });
</script>
</body>
</html>
